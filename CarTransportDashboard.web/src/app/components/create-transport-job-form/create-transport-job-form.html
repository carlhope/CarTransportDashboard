<p class="text-lg font-semibold mb-4 text-gray-700">Create Transport Job</p>

<form [formGroup]="jobForm" (ngSubmit)="onSubmit()" class="space-y-6 bg-white p-6 rounded-lg shadow-md max-w-xl mx-auto">
  <div>
    <label class="block text-sm font-medium text-gray-700">Title</label>
    <input formControlName="title" class="mt-1 block w-full border border-gray-300 rounded-md p-2 focus:ring focus:ring-blue-300" />
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700">Description</label>
    <textarea formControlName="description" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md p-2 focus:ring focus:ring-blue-300"></textarea>
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700">Pickup Location</label>
    <input formControlName="pickupLocation" class="mt-1 block w-full border border-gray-300 rounded-md p-2 focus:ring focus:ring-blue-300" />
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700">Dropoff Location</label>
    <input formControlName="dropoffLocation" class="mt-1 block w-full border border-gray-300 rounded-md p-2 focus:ring focus:ring-blue-300" />
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700">Scheduled Date</label>
    <input type="date" formControlName="scheduledDate" class="mt-1 block w-full border border-gray-300 rounded-md p-2 focus:ring focus:ring-blue-300" />
  </div>

  <!-- Vehicle Selection Toggle -->
  <div>
    <label class="inline-flex items-center">
      <input type="checkbox" formControlName="useNewVehicle" class="mr-2">
      <span class="text-sm text-gray-700">Create New Vehicle</span>
    </label>
  </div>

  <!-- Existing Vehicle Dropdown -->
  @if(!jobForm.get('useNewVehicle')?.value){
    <div>
      <label class="block text-sm font-medium text-gray-700">Vehicle Registration</label>
      <input [formControl]="registrationSearch" class="mt-1 block w-full border border-gray-300 rounded-md p-2" />
      <button type="button" (click)="lookupVehicle()" class="mt-2 bg-blue-500 text-white px-4 py-1 rounded hover:bg-blue-600">
        Find Vehicle
      </button>
    </div>

    <!-- Vehicle Search Result -->
    @if(matchedVehicle){
      <div class="bg-green-50 p-4 rounded-md border border-green-300 mt-4">
      <p class="text-sm text-green-700 font-medium">Vehicle Found:</p>
      <p class="text-sm text-green-700">Make: {{ matchedVehicle.make }}</p>
      <p class="text-sm text-green-700">Model: {{ matchedVehicle.model }}</p>
      <p class="text-sm text-green-700">Registration: {{ matchedVehicle.registrationNumber }}</p>
    </div>
    }
   @else{
     <div class="bg-red-50 p-4 rounded-md border border-red-300 mt-4">
       <p class="text-sm text-red-700 font-medium">No matches found for that registration.</p>
     </div>
   }



  }
  @else{
    <!-- New Vehicle Fields -->
    <div formGroupName="assignedVehicle" class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700">Vehicle Make</label>
        <input formControlName="make" class="mt-1 block w-full border border-gray-300 rounded-md p-2" />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Vehicle Model</label>
        <input formControlName="model" class="mt-1 block w-full border border-gray-300 rounded-md p-2" />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">Registration Number</label>
        <input formControlName="registrationNumber" class="mt-1 block w-full border border-gray-300 rounded-md p-2" />
      </div>
    </div>
  }

  <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition">Create Job</button>
</form>

